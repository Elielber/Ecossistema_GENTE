<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Forense | Auditoria Cient√≠fica de Decis√µes</title>
	<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üîç</text></svg>">
	
    
    <script src="https://cdn.tailwindcss.com"></script>
   <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/legacy/build/pdf.min.js"></script>
    <script>pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/legacy/build/pdf.worker.min.js';</script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #0f172a; padding-bottom: 80px; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>

    <header class="bg-slate-900 text-white p-4 shadow-md sticky top-0 z-50 border-b-4 border-slate-700">
        <h1 class="text-lg font-bold tracking-tight">üîç Forense</h1>
        <p class="text-[11px] text-slate-400 font-medium uppercase tracking-widest">Auditoria Cient√≠fica e Rastreabilidade</p>
    </header>

    <main class="p-4">

        <section id="tab-analisar" class="tab-content active">
            <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-200 mb-4">
                <h2 class="font-semibold text-slate-800 mb-2">Acervo Documental da Auditoria</h2>
                <p class="text-xs text-slate-500 mb-5 leading-relaxed">
                    Classifique e carregue os documentos que comp√µem esta decis√£o. O Forense agrupar√° of√≠cios e votos como <strong>"Tese Oficial"</strong>, e artigos ou manifestos como <strong>"Contraponto/Contexto"</strong>.
                </p>
                
                <div class="bg-slate-50 p-4 rounded-lg border border-slate-200 mb-4 space-y-4">
    
    <div>
        <label class="block text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-1">Papel na Auditoria (Posi√ß√£o):</label>
        <select id="doc-classificacao" class="w-full text-sm p-2 border border-slate-300 rounded-md bg-white text-slate-700 focus:outline-none focus:border-slate-500">
            <option value="oficial_">Documento Oficial (Tese / Decis√£o da Gest√£o)</option>
            <option value="critica_">Documento de Contraponto (Ant√≠tese / Manifesto)</option>
        </select>
    </div>

                    
                    <div class="mb-3">
                        <label class="block text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-1">Arquivo (PDF ou TXT):</label>
                        <input type="file" id="doc-arquivo" accept=".pdf,.txt" class="block w-full text-sm text-slate-500 file:mr-3 file:py-1.5 file:px-3 file:rounded-md file:border-0 file:text-xs file:font-bold file:bg-slate-200 file:text-slate-700 hover:file:bg-slate-300 cursor-pointer">
                    </div>
                    
                    <button onclick="adicionarDocumento()" class="w-full bg-slate-200 text-slate-700 font-semibold py-2 rounded-md hover:bg-slate-300 transition text-xs uppercase tracking-wide">
                        + Adicionar ao Dossi√™
                    </button>
                </div>

                <div class="mb-4 flex items-center justify-between bg-amber-50 p-3 rounded-lg border border-amber-200">
                    <label for="ha-contraponto" class="text-xs font-bold text-amber-800 flex flex-col cursor-pointer w-full">
                        <span>Existe manifesta√ß√£o de contraponto?</span>
                        <span class="text-[10px] text-amber-600 font-normal">Alerte o sistema se a decis√£o sofreu cr√≠ticas ou abaixo-assinados (Auditoria de Groupthink).</span>
                    </label>
                    <input type="checkbox" id="ha-contraponto" class="w-5 h-5 text-amber-600 bg-white border-amber-300 rounded focus:ring-amber-500 cursor-pointer">
                </div>
                </div>

                <div class="mb-6">
                    <h3 class="text-xs font-bold text-slate-700 uppercase border-b border-slate-200 pb-1 mb-2">Documentos em Mem√≥ria</h3>
                    <ul id="lista-documentos" class="space-y-2 empty:after:content-['Nenhum_documento_carregado.'] empty:after:text-xs empty:after:text-slate-400"></ul>
                </div>

                <button onclick="processarDossie()" id="btn-processar" class="w-full bg-slate-800 text-white font-semibold py-3 rounded-lg shadow-sm hover:bg-slate-900 transition flex justify-center items-center text-sm uppercase tracking-wide">
                    Executar Auditoria Cient√≠fica
                </button>
                
                <div id="loading-indicator" class="hidden text-center mt-3 text-xs text-slate-600 font-medium animate-pulse uppercase tracking-widest">
                    Processando Acervo Documental...
                </div>
            </div>
        </section>

        <section id="tab-relatorio" class="tab-content">
            <div id="resultado-vazio" class="text-center text-slate-500 py-10">
                <p class="text-sm">Aguardando processamento documental.</p>
            </div>
            
            <div id="resultado-preenchido" class="hidden space-y-4">
                
                <div class="bg-white p-5 rounded-xl border-l-4 border-slate-800 shadow-sm">
                    <div class="flex items-center justify-between mb-2">
                        <h2 class="text-xs font-bold text-slate-500 uppercase tracking-widest">Estrutura L√≥gica da Decis√£o</h2>
                        <span class="text-[10px] bg-slate-100 text-slate-500 px-2 py-1 rounded font-mono">M√©todo de Toulmin</span>
                    </div>
                    <p class="text-[11px] text-slate-500 mb-3 border-b border-slate-100 pb-2">O modelo de Toulmin desconstr√≥i o texto identificando a "Alega√ß√£o Central" (a a√ß√£o diretiva imposta) e as suas "Garantias" jur√≠dicas e institucionais.</p>
                    
                    <h3 class="font-semibold text-sm text-slate-800 mb-1">Alternativas Impostas (Alega√ß√£o):</h3>
                    <ul id="lista-alternativas" class="list-disc list-inside text-sm text-slate-700 mb-3 space-y-1"></ul>
                </div>

                <div class="bg-white p-5 rounded-xl border-l-4 border-blue-600 shadow-sm">
                    <div class="flex items-center justify-between mb-2">
                        <h2 class="text-xs font-bold text-blue-600 uppercase tracking-widest">Infer√™ncia de Prioridades</h2>
                        <span class="text-[10px] bg-blue-50 text-blue-600 px-2 py-1 rounded font-mono">An√°lise de Conte√∫do (Bardin)</span>
                    </div>
                    <p class="text-[11px] text-slate-500 mb-3 border-b border-slate-100 pb-2">A An√°lise de Conte√∫do de Laurence Bardin rastreia a frequ√™ncia e a coocorr√™ncia sem√¢ntica das palavras para inferir o peso qualitativo atribu√≠do pelo decisor a cada crit√©rio.</p>
                    
                    <h3 class="font-semibold text-sm text-slate-800 mb-1">Crit√©rios-Matriz Extra√≠dos:</h3>
                    <div id="tags-criterios" class="flex flex-col gap-2 mt-2"></div>
                </div>

                <div class="bg-white p-5 rounded-xl border-l-4 border-amber-500 shadow-sm">
                    <div class="flex items-center justify-between mb-2">
                        <h2 class="text-xs font-bold text-amber-600 uppercase tracking-widest">Auditoria de Vieses e Omiss√µes</h2>
                        <span class="text-[10px] bg-amber-50 text-amber-600 px-2 py-1 rounded font-mono">An√°lise Cr√≠tica (ACD)</span>
                    </div>
                    <p class="text-[11px] text-slate-500 mb-3 border-b border-slate-100 pb-2">A An√°lise Cr√≠tica do Discurso (Norman Fairclough) investiga o enquadramento institucional, identificando pontos de tens√£o (vi√©s de confirma√ß√£o e omiss√µes estrat√©gicas) em rela√ß√£o aos contrapontos.</p>
                    
                    <ul id="lista-alertas" class="space-y-4 text-sm text-slate-700 mt-2"></ul>
                </div>
				<div class="bg-white p-5 rounded-xl border-l-4 border-indigo-600 shadow-sm mt-4">
                    <div class="flex items-center justify-between mb-3">
                        <h2 class="text-xs font-bold text-indigo-600 uppercase tracking-widest">Proje√ß√£o Estrat√©gica de Cen√°rios</h2>
                        <span class="text-[10px] bg-indigo-50 text-indigo-600 px-2 py-1 rounded font-mono">Teoria dos Jogos</span>
                    </div>
                    <p class="text-[11px] text-slate-500 mb-4 border-b border-slate-100 pb-3">C√°lculo preditivo do comportamento organizacional p√≥s-decis√£o (Equil√≠brio de Nash), baseado no choque de interesses extra√≠do dos documentos.</p>
                    
                    <div id="matriz-plays-container" class="bg-slate-50 rounded-lg p-3 border border-slate-200">
                        </div>
                    
                    <div class="mt-4 flex items-center justify-between">
                        <div class="text-[11px] text-slate-500">Para detalhamento gr√°fico e simula√ß√£o avan√ßada:</div>
                        <button onclick="switchTab('exportar')" class="text-xs text-indigo-600 font-bold hover:underline">Ver Exporta√ß√£o PLAYS &rarr;</button>
                    </div>
                </div>
            </div>
        </section>

       <section id="tab-briefing" class="tab-content">
            <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-200 mb-4">
                <div class="flex items-center justify-between mb-2">
                    <h2 class="font-semibold text-slate-800">Resumo Executivo (Preview)</h2>
                    <span class="text-[10px] bg-green-100 text-green-700 px-2 py-1 rounded font-bold uppercase">Tom Relacional</span>
                </div>
                
                <div id="texto-resumo" class="text-sm text-slate-700 leading-relaxed space-y-3 bg-slate-50 p-4 rounded-lg border border-slate-100 mb-6">
                    Execute a auditoria para visualizar o resumo.
                </div>
                
                <h2 class="font-semibold text-slate-800 mb-2 border-t border-slate-100 pt-4">Distribui√ß√£o Estrat√©gica</h2>
                <p class="text-[11px] text-slate-500 mb-4">
                    O <strong>WhatsApp</strong> copiar√° o texto relacional acima. O <strong>PDF</strong> gerar√° o dossi√™ com o aprofundamento das 4 metodologias.
                </p>
                
                <div class="space-y-3">
                    <button onclick="copiarZap()" class="w-full bg-[#25D366] text-white font-bold py-3 px-4 rounded-lg shadow-sm hover:bg-[#1da851] transition text-sm flex items-center justify-between">
                        <span class="flex items-center gap-2">
                            <span class="text-lg">üí¨</span> Enviar Resumo p/ WhatsApp
                        </span>
                        <span class="text-[10px] uppercase opacity-80 font-normal tracking-widest">Copiar</span>
                    </button>
                    
                    <button onclick="baixarPDF()" class="w-full bg-slate-800 text-white font-bold py-3 px-4 rounded-lg shadow-sm hover:bg-slate-900 transition text-sm flex items-center justify-between uppercase tracking-wide">
                        <span class="flex items-center gap-2">
                            <span class="text-lg">üìÑ</span> Dossi√™ Anal√≠tico (PDF)
                        </span>
                        <span class="text-[10px] opacity-80 font-normal tracking-widest">Baixar</span>
                    </button>
                </div>
            </div>
        </section>
		
        <section id="tab-exportar" class="tab-content">
            <div class="grid grid-cols-1 gap-4">
                <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-200">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-bold text-slate-800 text-sm uppercase">Exporta√ß√£o Matem√°tica (ANP)</h3>
                        <span class="text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded">M√©todo de Saaty</span>
                    </div>
                    <p class="text-xs text-slate-500 mb-4">Gera a matriz estruturada para o <strong>Analytic Network Process</strong>. Fundamental para calcular a Raz√£o de Consist√™ncia (CR) e provar a integridade l√≥gica dos pesos decis√≥rios adotados na portaria.</p>
                    <button onclick="exportarANP()" class="bg-slate-800 text-white px-4 py-3 rounded-lg text-xs font-bold uppercase w-full tracking-widest hover:bg-slate-700">Baixar JSON (ANP-Solver)</button>
                </div>
                
                <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-200">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-bold text-slate-800 text-sm uppercase">Mapeamento Sist√™mico (CATWOE)</h3>
                        <span class="text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded">Sistemas Checkland</span>
                    </div>
                    <p class="text-xs text-slate-500 mb-4">Exporta a taxonomia da decis√£o para o <strong>Peixe-Voador</strong>, organizando o problema sob a √≥tica dos Atores, Transforma√ß√£o, Vis√£o de Mundo e Restri√ß√µes Ambientais.</p>
                    <button onclick="exportarPeixe()" class="bg-slate-600 text-white px-4 py-3 rounded-lg text-xs font-bold uppercase w-full tracking-widest hover:bg-slate-500">Baixar JSON (Peixe-Voador)</button>
                </div>
				<div class="bg-white p-5 rounded-xl shadow-sm border border-slate-200">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-bold text-slate-800 text-sm uppercase">Proje√ß√£o de Cen√°rios (PLAYS)</h3>
                        <span class="text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded">Teoria dos Jogos</span>
                    </div>
                    <p class="text-xs text-slate-500 mb-4">Exporta o choque de interesses detectado nos documentos para simular as rea√ß√µes (Equil√≠brio de Nash) na ferramenta <strong>PLAYS</strong>.</p>
                    <button onclick="exportarPLAYS()" class="bg-indigo-600 text-white px-4 py-3 rounded-lg text-xs font-bold uppercase w-full tracking-widest hover:bg-indigo-500">Baixar JSON (PLAYS)</button>
                </div>
            </div>
        </section>

    </main>

    <nav class="fixed bottom-0 w-full bg-white border-t border-slate-200 flex justify-around items-center h-16 px-2 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] z-50">
        <button onclick="switchTab('analisar')" class="nav-btn active flex flex-col items-center p-2 text-slate-400 w-1/4" data-target="tab-analisar">
            <span class="text-xl mb-1">‚öôÔ∏è</span>
            <span class="text-[10px] font-bold uppercase">Auditar</span>
        </button>
        <button onclick="switchTab('relatorio')" class="nav-btn flex flex-col items-center p-2 text-slate-400 w-1/4" data-target="tab-relatorio">
            <span class="text-xl mb-1">üìä</span>
            <span class="text-[10px] font-bold uppercase">Resultados</span>
        </button>
        <button onclick="switchTab('briefing')" class="nav-btn flex flex-col items-center p-2 text-slate-400 w-1/4" data-target="tab-briefing">
            <span class="text-xl mb-1">üìë</span>
            <span class="text-[10px] font-bold uppercase">Parecer</span>
        </button>
        <button onclick="switchTab('exportar')" class="nav-btn flex flex-col items-center p-2 text-slate-400 w-1/4" data-target="tab-exportar">
            <span class="text-xl mb-1">üì§</span>
            <span class="text-[10px] font-bold uppercase">Exportar</span>
        </button>
    </nav>

    <style>
        .nav-btn.active { color: #0f172a; } 
        .nav-btn.active span:first-child { transform: scale(1.1); transition: 0.2s; }
    </style>

    <script>
        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
            document.getElementById('tab-' + tabId).classList.add('active');
            document.querySelector(`[data-target="tab-${tabId}"]`).classList.add('active');
            window.scrollTo(0, 0);
        }

        // --- Vari√°veis de Estado Global ---
        let dossieDocumentos = []; // Array que guardar√° os arquivos e classifica√ß√µes
        let dadosAuditoria = { alternativas: [], criteriosDirex: [], alertas: [], rawTextDirex: "", rawTextCritica: "" };

        // =====================================================================
        // GERENCIADOR DE DOCUMENTOS (Nova L√≥gica de M√∫ltiplos Arquivos)
        // =====================================================================
        function adicionarDocumento() {
            const inputClassificacao = document.getElementById('doc-classificacao');
		    const inputArquivo = document.getElementById('doc-arquivo');
            const file = inputArquivo.files[0];

            if (!file) {
                alert("Por favor, selecione um arquivo PDF ou TXT.");
                return;
            }

            // Pega o texto da op√ß√£o selecionada (ex: "Voto de Diretoria")
            const nomeClassificacao = inputClassificacao.options[inputClassificacao.selectedIndex].text;
            const tipo = inputClassificacao.value; // ex: "oficial_voto"

            dossieDocumentos.push({
                id: Date.now(),
                file: file,
                tipo: tipo,
				nomeAmigavel: nomeClassificacao,
                nomeArquivo: file.name
            });

            inputArquivo.value = ""; // Limpa o input
            atualizarListaDocumentos();
        }

        function removerDocumento(id) {
            dossieDocumentos = dossieDocumentos.filter(doc => doc.id !== id);
            atualizarListaDocumentos();
        }

        function atualizarListaDocumentos() {
            const ul = document.getElementById('lista-documentos');
            ul.innerHTML = dossieDocumentos.map(doc => `
                <li class="flex justify-between items-center bg-white border border-slate-200 p-2 rounded-md shadow-sm">
                    <div class="flex flex-col overflow-hidden">
                        <span class="text-[10px] font-bold text-slate-400 uppercase">${doc.nomeAmigavel}</span>
                        <span class="text-xs text-slate-700 truncate">${doc.nomeArquivo}</span>
                    </div>
                    <button onclick="removerDocumento(${doc.id})" class="text-red-500 hover:bg-red-50 p-1 rounded">
                        üóëÔ∏è
                    </button>
                </li>
            `).join('');
        }

        // =====================================================================
        // FUN√á√ÉO PRINCIPAL DE PROCESSAMENTO (Substitui a anterior)
        // =====================================================================
  
async function processarDossie() {
    const btn = document.getElementById('btn-processar');
    const loader = document.getElementById('loading-indicator');
    
    const temOficial = dossieDocumentos.some(doc => doc.tipo.startsWith('oficial_'));
    const temCritica = dossieDocumentos.some(doc => doc.tipo.startsWith('critica_'));
    
    // L√™ o Checkbox de Governan√ßa
    const elContraponto = document.getElementById('ha-contraponto');
    const exigeContraponto = elContraponto ? elContraponto.checked : false;

    if (!temOficial) {
        alert("Para garantir a validade da auditoria, adicione pelo menos um Documento Oficial (Tese).");
        return;
    }
    if (exigeContraponto && !temCritica) {
        alert("Alerta de Governan√ßa: Assinalou a exist√™ncia de contraponto. Adicione ao menos um documento classificado como 'Contraponto/Contexto'.");
        return;
    }

    btn.classList.add('hidden');
    loader.classList.remove('hidden');

    try {
        let textoOficialAcumulado = "";
        let textoCriticaAcumulado = "";
        let tipoDocumentoOficial = "Outro"; // Vari√°vel para guardar a chave

        for (const doc of dossieDocumentos) {
            const textoExtraido = await lerArquivoTextoOPDF(doc); 
            if (doc.tipo.startsWith('oficial_')) {
                textoOficialAcumulado += textoExtraido + " \n\n ";
            } else if (doc.tipo.startsWith('critica_')) {
                textoCriticaAcumulado += textoExtraido + " \n\n ";
            }
        }
        
        // 1. PR√â-PROCESSAMENTO BASE
        textoOficialAcumulado = preprocessarTexto(textoOficialAcumulado);
        textoCriticaAcumulado = preprocessarTexto(textoCriticaAcumulado);
        
        dadosAuditoria.rawTextDirex = textoOficialAcumulado;
        dadosAuditoria.rawTextCritica = textoCriticaAcumulado;
        
        // 2. ISOLAMENTO DO N√öCLEO PARA O GR√ÅFICO PRINCIPAL DE BARDIN
        // Esta Regex remove a Ementa e os Considerandos para que o gr√°fico da interface n√£o conte palavras do passado
        let textoOficialParaBardin = textoOficialAcumulado;
       const marcoDecisao = textoOficialAcumulado.match(/\b(?:RESOLVE|DECRETA|DECIDE|DETERMINA|PROMULGA)\b\s*[:-]?\s*(.*)/i);
        if (marcoDecisao && marcoDecisao[1].length > 50) {
            textoOficialParaBardin = marcoDecisao[1].trim();
        }

        // 3. EXECU√á√ÉO METODOL√ìGICA
       dadosAuditoria.alternativas = extratorToulmin(textoOficialAcumulado); // Toulmin tem sua pr√≥pria blindagem interna
        dadosAuditoria.criteriosDirex = extratorBardin(textoOficialParaBardin); // Bardin agora recebe s√≥ a decis√£o estrita!
        dadosAuditoria.alertas = extratorFairclough(textoOficialAcumulado, textoCriticaAcumulado); // Fairclough blinda internamente

        setTimeout(() => {
            renderizarRelatorio();
            renderizarProjecaoPlays();
            gerarResumoExecutivo();
            btn.classList.remove('hidden');
            loader.classList.add('hidden');
            switchTab('relatorio');
        }, 1000);

    } catch (error) {
        alert("Falha t√©cnica na extra√ß√£o e indexa√ß√£o de dados. Verifique a integridade dos ficheiros PDF.");
        console.error(error);
        btn.classList.remove('hidden');
        loader.classList.add('hidden');
    }
}

        // =====================================================================
        // LEITOR DE PDF E ARQUIVOS
        // =====================================================================
        async function lerArquivoTextoOPDF(docItem) {
            // No novo formato, docItem j√° cont√©m a propriedade 'file'
            const file = docItem.file || (docItem.files && docItem.files[0]);
            
            if (!file) return "";
            
            if (file.type === "application/pdf") {
                const fileUrl = URL.createObjectURL(file);
                try {
                    const pdf = await pdfjsLib.getDocument(fileUrl).promise;
                    let fullText = "";
                    for (let i = 1; i <= pdf.numPages; i++) {
                        const page = await pdf.getPage(i);
                        const textContent = await page.getTextContent();
                        fullText += textContent.items.map(item => item.str).join(" ") + " ";
                    }
                    URL.revokeObjectURL(fileUrl); 
                    return fullText;
                } catch (pdfError) {
                    URL.revokeObjectURL(fileUrl); 
                    console.error("Erro interno no motor PDF:", pdfError);
                    alert(`Aviso: O PDF "${file.name}" possui restri√ß√µes que impedem a extra√ß√£o.`);
                    return "";
                }
            } else {
                return await file.text();
            }
        }
		
		// =====================================================================
        // PR√â-PROCESSAMENTO (Sanitiza√ß√£o e Normaliza√ß√£o)
        // =====================================================================
        function preprocessarTexto(s) {
            if (!s) return "";
            // Normaliza espa√ßos e quebras
            s = s.replace(/\r/g, "\n").replace(/\n{2,}/g, "\n").replace(/[ \t]{2,}/g, " ");
            // Remove cabe√ßalhos e n√∫meros de p√°gina intrusivos do OCR
            s = s.replace(/p√°gina\s+\d+(\s+de\s+\d+)?/gi, "").replace(/\b\d+\s*\/\s*\d+\b/g, "");
            s = s.replace(/(Memorando|Portaria|Of√≠cio|Resolu√ß√£o)\s*(N¬∫|n¬∫)?/gi, "");
            // Des-hifeniza√ß√£o inteligente
            s = s.replace(/-\s*\n\s*/g, "");
            return s.trim();
        }

        function normalizarParaContagem(s) {
            return s.toLowerCase()
                .normalize('NFD').replace(/[\u0300-\u036f]/g, '') // Remove acentos
                .replace(/[^a-z0-9\s]/g, ' ')
                .replace(/\s{2,}/g, ' ').trim();
        }

        // =====================================================================
        // MOTORES METODOL√ìGICOS (Intelig√™ncia Din√¢mica e Global)
        // =====================================================================
        
    
        
function extratorToulmin(textoBase) {
    // =========================================================
    // 1. SANITIZA√á√ÉO UNIVERSAL (Limpeza de OCR e PDF)
    // =========================================================
    let textoLimpo = textoBase.replace(/\s+/g, " ")
                              .replace(/f\s+i\s+c/gi, "fic")
                              .replace(/f\s+i\s+n/gi, "fin")
                              .replace(/e\s+s\s+p\s+e\s+c\s+√≠\s+f\s+i\s+c\s+a/gi, "espec√≠fica");

    const clichesAdministrativos = /entra em vigor na data|disposi√ß√µes em contr√°rio|casos omissos|revogam-se|publique-se|cumpra-se|data de (sua )?publica√ß√£o|destinat√°rio e pode conter|informa√ß√µes confidenciais|protegid[ao]s por sigilo/i;

    // =========================================================
    // 2. A CADEIA DE RESPONSABILIDADE (Array de Motores)
    // =========================================================
    const motoresPLN = [
        
        // --- MOTOR 1: NORMATIVO (O Estado) - ALTA PRECIS√ÉO ---
        {
            nome: "Motor Normativo",
            detector: (t) => t.match(/(?:^|\s)(RESOLVE|DECRETA|DECIDE|DETERMINA|PROMULGA)(?:\s*[:-]?\s*)(.*)/i),
            extrator: (t, match) => {
                let nucleo = match[2].split(/(?:Belo Horizonte|S√£o Paulo|Bras√≠lia|Rio de Janeiro|Data de Inser√ß√£o|Prefeito|Ministr[ao]|Publique-se|Cumpra-se)/i)[0];
                
                const regexDispositivos = /(Art\.\s*\d+[a-z¬∫o\.\-]*|¬ß\s*\d+[a-z¬∫o\.\-]*|\b[IVXLCDM]+\s*[-‚Äì‚Äî])\s*(.*?)(?=(?:Art\.\s*\d+|¬ß\s*\d+|\b[IVXLCDM]+\s*[-‚Äì‚Äî]|$))/gi;
                let validos = [];
                let m;
                
                while ((m = regexDispositivos.exec(nucleo)) !== null) {
                    let rotulo = m[1].trim(); 
                    let textoDispositivo = m[2].trim();
                    let ehCascaLegislativa = /passa(?:m)? a vigorar|acrescido ao referido|seguinte reda√ß√£o|seguinte altera√ß√£o/i.test(textoDispositivo);
                    
                    if (textoDispositivo.length > 20 && !clichesAdministrativos.test(textoDispositivo) && !ehCascaLegislativa) {
                        validos.push({ rotulo: rotulo, texto: textoDispositivo });
                    }
                }
                
                if (validos.length > 0) {
                    const radarImpacto = /obrig|ved|proib|instit|estabelec|garant|direit|dever|requisit|crit√©ri|praz|valor|remunera|benef√≠ci|acess|uso|norm|regr|alter|trabalho|jornada|h√≠brido|teletrabalho|presencial|limita|exced/i;
                    let dispositivosFocados = validos.filter(d => radarImpacto.test(d.texto));
                    let selecao = dispositivosFocados.length > 0 ? dispositivosFocados.slice(0, 3) : validos.slice(0, 3);
                    
                    return selecao.map(d => `<strong>${d.rotulo} (Alega√ß√£o Normativa):</strong> ` + d.texto.substring(0, 400) + (d.texto.length > 400 ? "..." : ""));
                }
                return null;
            }
        },

        // --- MOTOR 2: CONTRATUAL E SINDICAL (O Pacto) ---
        {
            nome: "Motor Contratual",
            detector: (t) => t.match(/\bCL√ÅUSULA\b/i) && t.match(/\b(?:ACORDO|CONVEN√á√ÉO|CONTRATO|TERMO|PACTO)\b/i),
            extrator: (t) => {
                const regexClausulas = /Cl√°usula\s+(?:Primeira|Segunda|Terceira|Quarta|Quinta|Sexta|S√©tima|Oitava|Nona|D√©cima|\d+)[a-z¬∫o\.\-]*\s*[:-]?\s*(.*?)(?=(?:Cl√°usula\s+|$))/gi;
                let validos = [];
                let m;
                while ((m = regexClausulas.exec(t)) !== null) {
                    if (m[1].trim().length > 20 && !clichesAdministrativos.test(m[1])) {
                        let rotulo = m[0].match(/Cl√°usula\s+[^\s:-]+/i)[0];
                        validos.push(`<strong>${rotulo} (Alega√ß√£o Contratual):</strong> ` + m[1].trim().substring(0, 300) + "...");
                    }
                }
                return validos.length > 0 ? validos.slice(0, 2) : null;
            }
        },

        // --- MOTOR 3: DELIBERATIVO E COLEGIADO (A Vota√ß√£o) ---
        {
            nome: "Motor Colegiado",
            detector: (t) => t.match(/\b(?:Ata da|Aos.*?dias do m√™s|Reuni√£o Ordin√°ria|Assembleia Geral|Sess√£o Plen√°ria|Conselho de|Diretoria Executiva|DIREX)\b/i),
            extrator: (t) => {
                const verbosConsenso = ["aprovou", "aprovaram", "deliberou", "deliberaram", "decidiu", "decidiram"];
                const regexConsenso = new RegExp(`(?:^|\\s)(?:${verbosConsenso.join("|")})(?=\\s|[.,;:!?]|$)`, "i");
                const sentencas = t.split(/(?<=[.;:!])\s+/);
                let validos = [];

                for (let s of sentencas) {
                    s = s.trim();
                    if (s.length < 20 || clichesAdministrativos.test(s) || s.toLowerCase().includes("considerando")) continue;
                    if (s.includes("@") || s.includes("|") || s.match(/\bEdi√ß√£o n/i) || s.match(/(?:^|\s)De:\s/i) || s.match(/(?:^|\s)Para:\s/i)) continue;
                    if (regexConsenso.test(s)) {
                        validos.push(s.replace(/^[-‚Ä¢*|]\s*/, "").charAt(0).toUpperCase() + s.slice(1));
                    }
                }
                
                if (validos.length > 0) {
                    // ATUALIZADO: Radar Universal de Impacto
                    const palavras = /obrig|ved|proib|instit|estabelec|garant|direit|dever|requisit|crit√©ri|praz|valor|remunera|benef√≠ci|acess|uso|norm|regr|alter|trabalho|jornada|h√≠brido/i;
                    let melhor = validos.find(d => palavras.test(d) && d.length < 350) || validos[0];
                    return [`<strong>Alega√ß√£o Deliberativa (Decis√£o Colegiada):</strong> ${melhor.substring(0, 300)}...`];
                }
                return null;
            }
        },

        // --- MOTOR 4: GERENCIALISTA E CORPORATIVO (A Narrativa) ---
        {
            nome: "Motor Corporativo",
            detector: (t) => true,
            extrator: (t) => {
                const atosCorporativos = [
                    "determina(?:r|do|da|m|mos)?", "determinou", "resolve(?:r|m|mos)?", "resolveu",
                    "institui(?:r|do|da|m|mos|u)?", "revoga(?:r|do|da|m|mos)?", "revogou",
                    "prorroga(?:r|do|da|m|mos)?", "prorrogou", "aprova(?:r|da|do|m|mos)?", "aprovou",
                    "estabelece(?:r|m|mos|u)?", "decid(?:e|iu|ir|em|imos)", "anuncia(?:r|m|mos|u)?",
                    "comunica(?:r|m|mos)?", "comunicou", "informa(?:r|m|mos)?", "informou",
                    "passar√° a", "passaremos a", "ir√° implementar", "ir√£o implementar"
                ];
                
                const regexVerbos = new RegExp(`(?:^|\\s)(?:${atosCorporativos.join("|")})(?=\\s|[.,;:!?]|$)`, "i");
                const sentencas = t.split(/(?<=[.;:!])\s+/);
                let validos = [];

                for (let s of sentencas) {
                    s = s.trim();
                    if (s.length < 20 || clichesAdministrativos.test(s) || s.toLowerCase().includes("considerando")) continue;
                    if (s.includes("@") || s.includes("|") || s.match(/\bEdi√ß√£o n/i) || s.match(/(?:^|\s)De:\s/i) || s.match(/(?:^|\s)Para:\s/i)) continue;

                    if (regexVerbos.test(s)) {
                        validos.push(s.replace(/^[-‚Ä¢*|]\s*/, "").charAt(0).toUpperCase() + s.slice(1));
                    }
                }
                
                if (validos.length > 0) {
                    // ATUALIZADO: Radar Universal de Impacto
                    const palavras = /obrig|ved|proib|instit|estabelec|garant|direit|dever|requisit|crit√©ri|praz|valor|remunera|benef√≠ci|acess|uso|norm|regr|alter|trabalho|jornada|h√≠brido/i;
                    let melhor = validos.find(a => palavras.test(a) && a.length < 350) || validos[0];
                    return [`<strong>Alega√ß√£o Central (Narrativa Corporativa):</strong> ${melhor.substring(0, 300)}...`];
                }
                return null;
            }
        }
    ];

    // =========================================================
    // 3. EXECU√á√ÉO DA CADEIA (Pipeline)
    // =========================================================
    for (let motor of motoresPLN) {
        let match = motor.detector(textoLimpo);
        if (match) {
            let resultado = motor.extrator(textoLimpo, match);
            if (resultado && resultado.length > 0) {
                return resultado;
            }
        }
    }

    // =========================================================
    // 4. FALLBACK DE SEGURAN√áA (Zero-Trust)
    // =========================================================
    return ["Ato impositivo impl√≠cito. Requer revis√£o manual do escopo decis√≥rio."];
}

		
        function extratorBardin(textoBase) {
            const textoNorm = normalizarParaContagem(textoBase);
            const totalTokens = Math.max(1, textoNorm.split(/\s+/).length); 
            
            const taxonomia = {
                "Cultura Organizacional e Sinergia": ["cultura", "integracao", "pertencimento", "alinhamento", "colaboracao", "clima", "presencial", "sinergia", "engajamento", "comunicacao", "proposito", "identidade"],
                "Gest√£o de Pessoas e Sa√∫de": ["saude", "bem estar", "motivacao", "retencao", "turnover", "capacitacao", "treinamento", "absenteismo", "assiduidade", "carreira", "ergonomia", "psicologic", "medico", "atestado"],
                "Seguran√ßa e Risco Jur√≠dico": ["passivo", "juridic", "controle", "jornada", "legislacao", "seguranca", "ponto", "roleta", "lei", "norma", "trabalhist", "sindicat", "acordo", "convencao", "estatuto"],
                "Governan√ßa e Transpar√™ncia": ["auditoria", "compliance", "etica", "transparencia", "prestacao", "tcu", "cgu", "probidade", "integridade", "diretriz", "fiscalizacao", "rigor"],
                "Desempenho e Produtividade": ["desempenho", "produtividade", "eficiencia", "resultado", "entrega", "meta", "kpi", "eficacia", "efetividade", "indicador", "agilidade", "qualidade", "prazo"],
                "Opera√ß√µes e Log√≠stica": ["operacao", "logistica", "processo", "fluxo", "cadeia", "suprimento", "manutencao", "infraestrutura", "equipamento", "maquinario", "frota", "planta", "fabrica"],
                "Sustentabilidade Financeira": ["financeir", "custo", "despesa", "orcamento", "economia", "gasto", "investimento", "capex", "opex", "receita", "faturamento", "contingenciamento", "corte", "tesouraria"],
                "Inova√ß√£o e Tecnologia": ["inovacao", "tecnologia", "sistema", "digital", "transformacao", "automatizacao", "software", "dados", "inteligencia", "modernizacao", "ti", "nuvem", "rede"],
                "Sustentabilidade e ESG": ["ambiental", "social", "governanca", "esg", "sustentavel", "ecologico", "diversidade", "inclusao", "impacto", "verde", "emissao", "lixo", "residuo"]
            };

            const referencias = {
                "Cultura Organizacional e Sinergia": "Ref: Teoria da Cultura Organizacional (E. Schein) e Aprendizagem (Balanced Scorecard).",
                "Gest√£o de Pessoas e Sa√∫de": "Ref: Comportamento Organizacional e Perspetiva de Aprendizagem e Crescimento (BSC).",
                "Seguran√ßa e Risco Jur√≠dico": "Ref: Framework de Gest√£o de Riscos (COSO) e Diretrizes de Compliance (IBGC).",
                "Governan√ßa e Transpar√™ncia": "Ref: Framework COSO e Pr√°ticas de Governan√ßa Corporativa (IBGC).",
                "Desempenho e Produtividade": "Ref: Perspetiva de Processos Internos (Balanced Scorecard - Kaplan & Norton).",
                "Opera√ß√µes e Log√≠stica": "Ref: Cadeia de Valor (Michael Porter) e Lean Management (Sistema Toyota).",
                "Sustentabilidade Financeira": "Ref: Perspetiva Financeira (Balanced Scorecard - Kaplan & Norton).",
                "Inova√ß√£o e Tecnologia": "Ref: Perspetiva de Inova√ß√£o (BSC) e Gest√£o da Mudan√ßa Tecnol√≥gica.",
                "Sustentabilidade e ESG": "Ref: Triple Bottom Line (John Elkington) e Framework ESG."
            };

            let criteriosExtraidos = [];

            for (let [categoria, radicais] of Object.entries(taxonomia)) {
                let frequencia = 0;
                radicais.forEach(radical => {
                    let regex = new RegExp(`\\b${radical}\\w*\\b`, "gi");
                    let ocorrencias = textoNorm.match(regex);
                    if (ocorrencias) frequencia += ocorrencias.length;
                });

                if (frequencia > 0) {
                    let freqRelativa = +(frequencia / totalTokens * 1000).toFixed(2);
                    let pesoQualitativo = freqRelativa >= 4 ? "Prioridade M√°xima" : "Vari√°vel de Apoio";
                    
                    criteriosExtraidos.push({
                        nome: categoria, 
                        frequencia: freqRelativa,
                        analise: `Dete√ß√£o de ${frequencia} termos associados. Classifica√ß√£o: ${pesoQualitativo} (Densidade: ${freqRelativa}/1k).`,
                        referencia: referencias[categoria] || "Ref: Melhores Pr√°ticas de Gest√£o Corporativa."
                    });
                }
            }
            return criteriosExtraidos.sort((a, b) => b.frequencia - a.frequencia);
        }

       function extratorFairclough(textoDir, textoCrit) {
    let alertas = [];

    // =========================================================
    // BLINDAGEM PRELIMINAR: ISOLAMENTO DO N√öCLEO DISCURSIVO
    // =========================================================
    function isolarNucleo(texto) {
        if (!texto) return "";
        let textoLimpo = texto.replace(/\s+/g, " ");
        
        // 1. Tenta encontrar o marco decis√≥rio (t√≠pico do Documento Oficial)
        const marcoDecisao = textoLimpo.match(/\b(?:RESOLVE|DECRETA|DECIDE|DETERMINA|PROMULGA)\b\s*[:-]?\s*(.*)/i);
        if (marcoDecisao && marcoDecisao[1].length > 50) {
            return marcoDecisao[1].trim();
        }
        
        // 2. Fallback para o Contraponto (Remove par√°grafos de "Considerando")
        const regexConsiderandos = /Considerando[\s\S]+?(?:\.|\;)/gi;
        let textoSemConsiderandos = textoLimpo.replace(regexConsiderandos, "");
        
        return textoSemConsiderandos.trim();
    }

    // Aplica a blindagem ao texto oficial antes de qualquer contagem
    const dirBlindado = isolarNucleo(textoDir);
    const dirLower = dirBlindado.toLowerCase();
    
    // =========================================================
    // N√çVEL 1: MODALIZA√á√ÉO E TOM DA DECIS√ÉO (Autoridade)
    // =========================================================
    const deonticos = (dirLower.match(/(deve|determina|proibi|veda|obriga|impost|compulsori|imprescindivel|terminantemente)/gi) || []).length;
    const propositivos = (dirLower.match(/(sugere|recomenda|orienta|faculta|opcional|alternativa|dialogo|consenso)/gi) || []).length;
    const legitimacao = (dirLower.match(/(conforme lei|decreto|tcu|cgu|constituicao|clt|jurisprudencia|acordao|norma|estatuto|legal)/gi) || []).length;

    if (deonticos > propositivos * 2 && deonticos >= 2) {
        alertas.push(`<strong>Modaliza√ß√£o Autorit√°ria (For√ßa De√¥ntica):</strong> O texto oficial utiliza tom altamente impositivo (${deonticos} marcadores de obriga√ß√£o). Este formato "Top-Down" reduz a margem de ambiguidade, mas eleva drasticamente o risco de atrito e resist√™ncia passiva se n√£o houver forte legitima√ß√£o.`);
    } else if (propositivos > deonticos && propositivos >= 2) {
        alertas.push(`<strong>Modaliza√ß√£o Propositiva (Soft Power):</strong> A diretriz adota um tom flex√≠vel ou recomendat√≥rio. Cuidado: Textos excessivamente brandos em decis√µes estruturais podem gerar v√°cuos de execu√ß√£o e dupla interpreta√ß√£o na base operacional.`);
    }

    if (legitimacao >= 3) {
        alertas.push(`<strong>Estrat√©gia de Legitima√ß√£o Externa:</strong> A decis√£o ancora-se fortemente em autoridades externas ou arcabou√ßo legal (${legitimacao} men√ß√µes). T√°tica eficaz para blindar o decisor, transferindo o "√≥nus" da mudan√ßa para o cumprimento de regras superiores.`);
    }

    // =========================================================
    // N√çVEL 2: CRUZAMENTO COM O CONTRAPONTO (Conflito)
    // =========================================================
    if (textoCrit && textoCrit.trim().length > 10) {
        // Aplica a blindagem ao manifesto da oposi√ß√£o
        const critBlindado = isolarNucleo(textoCrit);
        const critLower = critBlindado.toLowerCase();
        
        // Term√≥metro de Hostilidade
        const resistencia = (critLower.match(/(inviavel|ilegal|abusiv|precariza|retrocesso|inaceitavel|repudia|imposicao|arbitrari|desgaste|prejuizo|assedio)/gi) || []).length;

        if (resistencia >= 3) {
            alertas.push(`<strong>Term√≥metro de Hostilidade Elevado:</strong> O documento opositor utiliza linguagem de confronto direto ou alerta de dano severo (${resistencia} marcadores agressivos detetados). O risco de judicializa√ß√£o ou paralisa√ß√£o sindical √© iminente.`);
        }

        // Extra√ß√£o Sem√¢ntica Cruzada (Bardin Integrado)
        // Usamos as vari√°veis blindadas para que o Bardin tamb√©m seja preciso!
        const criteriosOficial = extratorBardin(dirBlindado);
        const criteriosCritica = extratorBardin(critBlindado);
        const nomesOficial = criteriosOficial.map(c => c.nome);
        
        criteriosCritica.forEach(c => {
            // Vi√©s de Enquadramento
            if (c.frequencia >= 2 && !nomesOficial.includes(c.nome)) {
                alertas.push(`<strong>Vi√©s de Enquadramento Estrat√©gico:</strong> A oposi√ß√£o concentra a argumenta√ß√£o no eixo '<strong>${c.nome}</strong>'. A omiss√£o total deste tema na diretriz principal configura um ponto cego t√°tico (risco de governan√ßa em auditorias externas).`);
            }
            // Ruptura de Signos
            if (c.frequencia >= 2 && nomesOficial.includes(c.nome)) {
                alertas.push(`<strong>Ruptura de Signos (Disputa Sem√¢ntica):</strong> Diverg√™ncia aguda no crit√©rio '<strong>${c.nome}</strong>'. As partes utilizam o mesmo fundamento conceptual para defender cen√°rios pr√°ticos opostos. Requer blindagem m√©trica ou quantitativa imediata.`);
            }
        });
        
    } else {
        alertas.push("<strong>Isola√ß√£o Decis√≥ria (Groupthink):</strong> A decis√£o foi estruturada e analisada sem evid√™ncia de contraponto documentado. O vi√©s de isola√ß√£o institucional √© alto. Recomenda-se submeter manifesta√ß√µes do p√∫blico-alvo para mapeamento preventivo de conflitos laborais.");
    }
    
    return alertas;
}
        // =====================================================================
        // MOTOR PRINCIPAL (Com valida√ß√£o de Governan√ßa de Contraponto)
        // =====================================================================
        async function processarDossie() {
            const btn = document.getElementById('btn-processar');
            const loader = document.getElementById('loading-indicator');
            
            const temOficial = dossieDocumentos.some(doc => doc.tipo.startsWith('oficial_'));
            const temCritica = dossieDocumentos.some(doc => doc.tipo.startsWith('critica_'));
            
            // L√™ o Checkbox de Governan√ßa
            const elContraponto = document.getElementById('ha-contraponto');
            const exigeContraponto = elContraponto ? elContraponto.checked : false;

            if (!temOficial) {
                alert("Para garantir a validade da auditoria, adicione pelo menos um Documento Oficial (Tese).");
                return;
            }
            if (exigeContraponto && !temCritica) {
                alert("Alerta de Governan√ßa: Assinalou a exist√™ncia de contraponto. Adicione ao menos um documento classificado como 'Contraponto/Contexto'.");
                return;
            }

            btn.classList.add('hidden');
            loader.classList.remove('hidden');

            try {
                let textoOficialAcumulado = "";
                let textoCriticaAcumulado = "";

                for (const doc of dossieDocumentos) {
                    const textoExtraido = await lerArquivoTextoOPDF(doc); 
                    if (doc.tipo.startsWith('oficial_')) {
                        textoOficialAcumulado += textoExtraido + " \n\n ";
                    } else if (doc.tipo.startsWith('critica_')) {
                        textoCriticaAcumulado += textoExtraido + " \n\n ";
                    }
                }
                
                // 1. PR√â-PROCESSAMENTO 
                textoOficialAcumulado = preprocessarTexto(textoOficialAcumulado);
                textoCriticaAcumulado = preprocessarTexto(textoCriticaAcumulado);
                
                dadosAuditoria.rawTextDirex = textoOficialAcumulado;
                dadosAuditoria.rawTextCritica = textoCriticaAcumulado;
                
                // 2. EXECU√á√ÉO METODOL√ìGICA
                dadosAuditoria.alternativas = extratorToulmin(textoOficialAcumulado);
                dadosAuditoria.criteriosDirex = extratorBardin(textoOficialAcumulado);
                dadosAuditoria.alertas = extratorFairclough(textoOficialAcumulado, textoCriticaAcumulado);

                setTimeout(() => {
                    renderizarRelatorio();
                    renderizarProjecaoPlays();
                    gerarResumoExecutivo();
                    btn.classList.remove('hidden');
                    loader.classList.add('hidden');
                    switchTab('relatorio');
                }, 1000);

            } catch (error) {
                alert("Falha t√©cnica na extra√ß√£o e indexa√ß√£o de dados. Verifique a integridade dos ficheiros PDF.");
                console.error(error);
                btn.classList.remove('hidden');
                loader.classList.add('hidden');
            }
        }

        function renderizarRelatorio() {
            document.getElementById('resultado-vazio').classList.add('hidden');
            document.getElementById('resultado-preenchido').classList.remove('hidden');

            document.getElementById('lista-alternativas').innerHTML = dadosAuditoria.alternativas.map(a => `<li><span class="font-medium text-slate-800">${a}</span></li>`).join('');

            document.getElementById('tags-criterios').innerHTML = dadosAuditoria.criteriosDirex.map(c => 
                `<div class="bg-slate-50 border border-slate-200 p-2 rounded"><div class="font-bold text-slate-800 text-sm">${c.nome}</div><div class="text-[11px] text-slate-500 mt-1">${c.analise}</div></div>`
            ).join('');

            document.getElementById('lista-alertas').innerHTML = dadosAuditoria.alertas.map(a => `<li class="relative pl-5 before:content-[''] before:absolute before:left-0 before:top-2 before:w-2 before:h-2 before:bg-amber-500 before:rounded-full">${a}</li>`).join('');
        }

        
        // =====================================================================
        // MOTORES DE DISTRIBUI√á√ÉO (Resumo em Tela e WhatsApp)
        // =====================================================================

        function gerarResumoExecutivo() {
            if(!dadosAuditoria.alternativas.length) return;
            
            const temConflito = dadosAuditoria.alertas.some(a => a.includes("Disputa") || a.includes("Vi√©s"));
            const criterioPrincipal = dadosAuditoria.criteriosDirex[0]?.nome || "vari√°veis internas";
            
            let html = `<p><strong>Decis√£o Mapeada:</strong> ${dadosAuditoria.alternativas[0]}</p>`;
            html += `<p><strong>Foco da Narrativa:</strong> O algoritmo identificou que o peso maior da nossa justificativa est√° estruturado em <em>${criterioPrincipal}</em>.</p>`;
            
            if (temConflito) {
                html += `<p><strong>‚ö†Ô∏è Ponto de Aten√ß√£o:</strong> O cruzamento dos documentos aponta um desalinhamento importante com o p√∫blico afetado.</p>`;
                html += `<p><strong>Sugest√£o T√°tica:</strong> Para evitar um desgaste invis√≠vel (queda de produtividade), seria estrat√©gico pensarmos em alguma flexibiliza√ß√£o ou contrapartida operacional que traga a equipe para um cen√°rio de colabora√ß√£o.</p>`;
            } else {
                html += `<p><strong>Cen√°rio:</strong> O ambiente aponta para a absor√ß√£o da regra. Vale apenas monitorarmos o clima da equipe nos pr√≥ximos meses.</p>`;
            }
            
            document.getElementById('texto-resumo').innerHTML = html;
        }

        function copiarZap() {
            if(!dadosAuditoria.alternativas.length) return alert("Execute a auditoria primeiro.");
            
            const temConflito = dadosAuditoria.alertas.some(a => a.includes("Disputa") || a.includes("Vi√©s"));
            const criterioPrincipal = dadosAuditoria.criteriosDirex[0]?.nome || "crit√©rios internos";
            
            // Texto conversacional para WhatsApp
            let zap = `Ol√°! Passando para compartilhar um panorama r√°pido da an√°lise que rodei no sistema sobre a nossa decis√£o de *${dadosAuditoria.alternativas[0]}*.\n\n`;
            
            zap += `O algoritmo confirmou que a nossa justificativa est√° muito bem ancorada em *${criterioPrincipal}*.\n\n`;
            
            if(temConflito) {
                zap += `üö® *Ponto de aten√ß√£o:* O cruzamento dos documentos detectou um desalinhamento forte com a base (risco de resist√™ncia silenciosa).\n\n`;
                zap += `üí° *Sugest√£o:* Para n√£o travarmos a opera√ß√£o num cen√°rio de perde-perde, talvez seja interessante pensarmos em alguma contrapartida operacional ou projeto de gest√£o paralela para trazer a equipe de volta para o ganha-ganha.\n\n`;
            } else {
                zap += `üìä *Cen√°rio:* O sistema projeta que a decis√£o ser√° absorvida com tranquilidade, mas sugere acompanharmos o engajamento da equipe.\n\n`;
            }
            
            zap += `Se precisar do detalhamento t√©cnico para anexar a algum processo, me avisa que te mando o Dossi√™ completo em PDF gerado pelo sistema. Um abra√ßo!`;

            navigator.clipboard.writeText(zap).then(() => {
                alert("Resumo relacional copiado! Pronto para colar no WhatsApp.");
            });
        }

        function baixarPDF() {
            if(!dadosAuditoria.alternativas.length) return alert("Execute a auditoria primeiro.");
            const { jsPDF } = window.jspdf; const doc = new jsPDF();
            let y = 0; const margin = 20; const maxWidth = 170; const pageHeight = 280;
            const primaryColor = [20, 30, 50]; const secondaryColor = [80, 90, 110]; const accentColor = [37, 99, 235];
            
            function checkPageBreak(requiredSpace = 20) {
                if (y + requiredSpace > pageHeight) {
                    doc.addPage();
                    drawHeaderFooter();
                    y = 35; 
                }
            }

            function drawHeaderFooter() {
                const pageNum = doc.internal.getCurrentPageInfo().pageNumber;
                if (pageNum > 1) {
                    doc.setFillColor(245, 247, 250); doc.rect(0, 0, 210, 20, 'F');
                    doc.setFontSize(8); doc.setFont("helvetica", "bold"); doc.setTextColor(primaryColor[0], primaryColor[1], primaryColor[2]); doc.text("FORENSE", margin, 12);
                    doc.setFont("helvetica", "normal"); doc.setTextColor(150, 150, 150); doc.text("Auditoria Cient√≠fica de Decis√µes Institucionais", 210 - margin, 12, {align: "right"});
                    doc.setDrawColor(220, 220, 220); doc.line(margin, 20, 210 - margin, 20);
                }
                doc.setDrawColor(220, 220, 220); doc.line(margin, 285, 210 - margin, 285);
                doc.setFontSize(8); doc.setFont("helvetica", "italic"); doc.setTextColor(150, 150, 150);
                doc.text(`Gerado com seguran√ßa (Zero-Trust) em ${new Date().toLocaleDateString('pt-BR')}`, margin, 292);
                doc.setFont("helvetica", "normal"); doc.text(`P√°gina ${pageNum}`, 210 - margin, 292, {align: "right"});
            }

            function printParagraph(title, text, isMainTitle = false) {
                if(isMainTitle) {
                    checkPageBreak(30); y += 5; doc.setFontSize(14); doc.setFont("helvetica", "bold"); doc.setTextColor(primaryColor[0], primaryColor[1], primaryColor[2]);
                    doc.text(title, margin, y); y += 2; doc.setDrawColor(accentColor[0], accentColor[1], accentColor[2]); doc.setLineWidth(0.5); doc.line(margin, y, margin + 20, y); y += 8;
                } else if(title) {
                    checkPageBreak(15); doc.setFontSize(11); doc.setFont("helvetica", "bold"); doc.setTextColor(secondaryColor[0], secondaryColor[1], secondaryColor[2]);
                    doc.text(title, margin, y); y += 6;
                }
                
                if (text) {
                    doc.setFontSize(10); doc.setFont("helvetica", "normal"); doc.setTextColor(60, 60, 60);
                    const lines = doc.splitTextToSize(text, maxWidth); 
                    checkPageBreak(lines.length * 6); 
                    doc.text(lines, margin, y); 
                    y += (lines.length * 5) + 6; 
                }
            }
            
            // Fun√ß√£o dedicada para as Refer√™ncias Te√≥ricas
            function printReference(refText) {
                doc.setFontSize(8); doc.setFont("helvetica", "italic"); doc.setTextColor(120, 120, 120);
                const lines = doc.splitTextToSize(">> " + refText, maxWidth);
                checkPageBreak(lines.length * 5);
                doc.text(lines, margin + 5, y - 2); // Indentado e mais pr√≥ximo da linha de cima
                y += (lines.length * 4) + 6; 
            }

            // --- CAPA ---
            doc.setFillColor(primaryColor[0], primaryColor[1], primaryColor[2]); doc.rect(0, 0, 210, 80, 'F');
            doc.setFontSize(24); doc.setFont("helvetica", "bold"); doc.setTextColor(255, 255, 255); doc.text("PARECER T√âCNICO", margin, 45);
            doc.setFontSize(12); doc.setFont("helvetica", "normal"); doc.setTextColor(200, 210, 230); doc.text("Auditoria de Rastreabilidade e Cen√°rios Prospectivos", margin, 55);

            y = 100;
            doc.setFontSize(10); doc.setFont("helvetica", "bold"); doc.setTextColor(primaryColor[0], primaryColor[1], primaryColor[2]); doc.text("S√çNTESE EXECUTIVA", margin, y); y += 8;
            doc.setFont("helvetica", "normal");
            
            const txtCapa = "Compreendemos que transi√ß√µes estruturais e imposi√ß√µes de alto impacto sist√©mico s√£o os momentos mais sens√≠veis na Alta Gest√£o. Este relat√≥rio apoia as lideran√ßas com um diagn√≥stico isento que valida os aspetos priorit√°rios da decis√£o, rastreia assimetrias de interpreta√ß√£o e projeta potenciais rea√ß√µes na malha organizacional. O documento atua como radar preventivo na sustentabilidade das mudan√ßas propostas.";
            doc.text(doc.splitTextToSize(txtCapa, maxWidth), margin, y); drawHeaderFooter();
            
            // --- P√ÅGINA 2 ---
            doc.addPage(); drawHeaderFooter(); y = 35;
            printParagraph("1. Objeto da An√°lise e Estrutura", "Decis√£o Mapeada: " + dadosAuditoria.alternativas.join(" | "), true);
            printParagraph("An√°lise L√≥gica (Toulmin)", "A heur√≠stica validou o corpo documental para isolar e fixar o foco da 'Alega√ß√£o Central', desconsiderando ru√≠dos informativos e focando na mudan√ßa institucional promovida.");

            printParagraph("2. Fundamenta√ß√£o Qualitativa (Axiologia)", "", true);
            printParagraph("", "Baseado no m√©todo de Laurence Bardin, mape√°mos a densidade dos vocabul√°rios para inferir onde a Dire√ß√£o colocou o seu peso de argumenta√ß√£o e foco:");
            
            dadosAuditoria.criteriosDirex.forEach(c => {
                let analiseLimpa = c.analise.replace(/\[Bardin\] /g, "");
                printParagraph("‚Ä¢ " + c.nome.toUpperCase(), analiseLimpa);
                printReference(c.referencia);
            });

            // --- P√ÅGINA 3 ---
            doc.addPage(); drawHeaderFooter(); y = 35;
            printParagraph("3. Riscos de Governan√ßa (An√°lise Cr√≠tica)", "", true);
            printParagraph("", "O motor Fairclough cruzou a densidade argumentativa prim√°ria com o contexto paralelo/manifesta√ß√µes em busca de desn√≠veis interpretativos e vieses de gest√£o:");
            
            if(dadosAuditoria.alertas.length > 0) {
                dadosAuditoria.alertas.forEach(a => printParagraph("Alerta de Desvio Detectado", a.replace(/<\/?strong>/g, "")));
            } else {
                printParagraph("Diagn√≥stico de Seguran√ßa", "O acervo encontra-se conc√™ntrico; n√£o foram mapeadas fissuras discursivas evidentes nesta amostra documental.");
            }

            // --- P√ÅGINA 4 (NASH E DIAGRAMA) ---
            doc.addPage(); drawHeaderFooter(); y = 35;
            printParagraph("4. Proje√ß√£o Estrat√©gica (Equil√≠brio de Nash)", "", true);
            
            const introNash = "A Teoria dos Jogos (Equil√≠brio de Nash) modela matematicamente o comportamento humano face a imposi√ß√µes. Ela projeta que o estado final de um sistema n√£o depende apenas da vontade de uma das partes (a Gest√£o), mas da rea√ß√£o otimizada da outra parte (as Equipes). Atrav√©s da avalia√ß√£o das tens√µes discursivas detectadas (Metodologia de Fairclough), o motor mapeia a tend√™ncia do sistema a estabilizar num de quatro quadrantes.";
            printParagraph("Contextualiza√ß√£o da Matriz", introNash);

            const temConflito = dadosAuditoria.alertas.some(a => a.includes("Ruptura") || a.includes("Vi√©s") || a.includes("Hostilidade") || a.includes("Autorit√°ria") || a.includes("Isola√ß√£o"));
            const nash = temConflito ? "DD (Perde-Perde / Travamento e Retalia√ß√£o Oculta)" : "DC (Conformidade Funcional / Submiss√£o √† Nova Regra)";
            
            printParagraph("Estado Inicial Projetado do Sistema", nash);
            
            // Desenho da Matriz
            checkPageBreak(80);
            y += 5;
            
            const startX = 50; const boxSize = 40; const matrixY = y;
            
            doc.setFontSize(9); doc.setFont("helvetica", "bold"); doc.setTextColor(100, 100, 100);
            doc.text("ATOR B: EQUIPES", startX + boxSize, matrixY - 5, {align: "center"});
            doc.text("Coopera (C)", startX + (boxSize/2), matrixY + 5, {align: "center"});
            doc.text("Resiste (D)", startX + boxSize + (boxSize/2), matrixY + 5, {align: "center"});
            doc.text("ATOR A:\nGEST√ÉO", startX - 15, matrixY + 30, {align: "center"});
            doc.text("Mitiga (C)", startX - 5, matrixY + 25, {align: "right"});
            doc.text("Imp√µe (D)", startX - 5, matrixY + 65, {align: "right"});
            
            doc.setFillColor(240, 253, 244); doc.setDrawColor(200, 200, 200); doc.rect(startX, matrixY + 10, boxSize, boxSize, 'FD');
            doc.setFontSize(14); doc.setTextColor(22, 163, 74); doc.text("CC", startX + (boxSize/2), matrixY + 30, {align: "center"});
            doc.setFontSize(8); doc.setTextColor(100, 100, 100); doc.text("Produtividade M√°x.", startX + (boxSize/2), matrixY + 40, {align: "center"});

            doc.setFillColor(255, 255, 255); doc.rect(startX + boxSize, matrixY + 10, boxSize, boxSize, 'FD');
            doc.setFontSize(14); doc.setTextColor(150, 150, 150); doc.text("CD", startX + boxSize + (boxSize/2), matrixY + 30, {align: "center"});
            
            doc.setFillColor(temConflito ? 255 : 239, temConflito ? 255 : 246, temConflito ? 255 : 255);
            if (!temConflito) { doc.setDrawColor(59, 130, 246); doc.setLineWidth(0.8); }
            doc.rect(startX, matrixY + 10 + boxSize, boxSize, boxSize, 'FD');
            doc.setLineWidth(0.1); doc.setDrawColor(200, 200, 200);
            doc.setFontSize(14); doc.setTextColor(temConflito ? 150 : 37, temConflito ? 150 : 99, temConflito ? 150 : 235);
            doc.text("DC", startX + (boxSize/2), matrixY + 30 + boxSize, {align: "center"});
            if (!temConflito) { doc.setFontSize(8); doc.setTextColor(100, 100, 100); doc.text("Risco Turnover", startX + (boxSize/2), matrixY + 40 + boxSize, {align: "center"}); }

            doc.setFillColor(temConflito ? 254 : 255, temConflito ? 242 : 255, temConflito ? 242 : 255);
            if (temConflito) { doc.setDrawColor(239, 68, 68); doc.setLineWidth(0.8); }
            doc.rect(startX + boxSize, matrixY + 10 + boxSize, boxSize, boxSize, 'FD');
            doc.setLineWidth(0.1); doc.setDrawColor(200, 200, 200);
            doc.setFontSize(14); doc.setTextColor(temConflito ? 220 : 150, temConflito ? 38 : 150, temConflito ? 38 : 150);
            doc.text("DD", startX + boxSize + (boxSize/2), matrixY + 30 + boxSize, {align: "center"});
            if (temConflito) { doc.setFontSize(8); doc.setTextColor(100, 100, 100); doc.text("Perda Oculta", startX + boxSize + (boxSize/2), matrixY + 40 + boxSize, {align: "center"}); }
            
            y = matrixY + 110; 

            let nashText = temConflito 
                ? "Conclus√£o e Parecer: Identificou-se uma grave assimetria de interesses no mapeamento documental. Manter a imposi√ß√£o de forma r√≠gida (sem t√°ticas compensat√≥rias) for√ßar√° o sistema a ancorar no quadrante DD, prop√≠cio √† resist√™ncia n√£o-declarada, queda na qualidade operacional ou atrito persistente. √â imperativo adotar mecanismos de mitiga√ß√£o para reconduzir a base para o quadrante superior esquerdo (CC)."
                : "Conclus√£o e Parecer: Prev√™-se uma absor√ß√£o adequada da diretriz. Uma vez que a conformidade baseada em submiss√£o √† regra (DC) pode n√£o reter talentos a longo prazo, aconselha-se os l√≠deres a atuarem preventivamente na mitiga√ß√£o de sintomas de desgaste.";
            printParagraph("An√°lise e Parecer Final", nashText);

            doc.save("Parecer_Consultivo_Forense.pdf");
        }
        function downloadJSON(data, filename) {
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }

       // =====================================================================
        // EXPORTA√á√ïES (JSON) COM REDIRECIONAMENTO INTELIGENTE
        // =====================================================================
        function exportarANP() {
            if(!dadosAuditoria.alternativas.length) return alert("Execute a an√°lise t√©cnica primeiro.");
            const anpData = {
                metadata: { judgeRole: "Assessoria T√©cnica Especializada", context: "Modelagem Forense da Decis√£o", frameworkUsed: "Toulmin + Bardin" },
                dynamicClusters: {
                    ObjetivoPrincipal: "Auditoria Cient√≠fica do Regime de Trabalho",
                    "Criterios de Decisao": { elements: dadosAuditoria.criteriosDirex.map(c => c.nome) },
                    "Alternativas para alcane do Objetivo": { elements: dadosAuditoria.alternativas }
                }
            };
            downloadJSON(anpData, 'Auditoria_Estrutura_ANP.json');
            
            // Abre o ANP Solver na mesma pasta do GitHub Pages
            setTimeout(() => {
                window.open('anp-solver.html', '_blank');
            }, 1000); // Pequeno atraso para garantir o download primeiro
        }

        function exportarPeixe() {
             if(!dadosAuditoria.alternativas.length) return alert("Execute a an√°lise t√©cnica primeiro.");
             const peixeData = {
                effect: "Restabelecimento da Coes√£o Institucional e Seguran√ßa de Conformidade",
                sector: "generic",
                causes: {
                    transformation: dadosAuditoria.alternativas.map(a => ({text: "*" + a})),
                    worldview: dadosAuditoria.criteriosDirex.map(c => ({text: c.nome + " como vetor inegoci√°vel da institui√ß√£o."}))
                }
            };
            downloadJSON(peixeData, 'Auditoria_Mapeamento_CATWOE.json');
            
            // Abre o Peixe Voador na mesma pasta do GitHub Pages
            setTimeout(() => {
                window.open('peixe-voador.html', '_blank');
            }, 1000);
        }

        function exportarPLAYS() {
            if(!dadosAuditoria.alternativas.length) return alert("Execute a an√°lise t√©cnica primeiro.");
            
            const temConflito = dadosAuditoria.alertas.some(a => a.includes("Disputa") || a.includes("Vi√©s") || a.includes("Hostilidade") || a.includes("Autorit√°ria") || a.includes("Isola√ß√£o"));
            
            const playsData = {
              "projectMeta": {
                "title": "Proje√ß√£o Forense: " + dadosAuditoria.alternativas[0],
                "context": "An√°lise de impactos e rea√ß√µes p√≥s-decis√£o institucional.",
                "objective": "Mapear o Equil√≠brio de Nash do conflito documental."
              },
              "nodes": [
                { "id": "decisao_oficial", "label": "A Decis√£o:\n" + dadosAuditoria.alternativas[0], "group": "project", "title": "Ato imposto pelo documento oficial" },
                { "id": "jogador_A", "label": "Gest√£o (DIREX)\n(Autor do Voto)", "group": "actor", "interest": 8, "title": "Objetivo: " + (dadosAuditoria.criteriosDirex[0]?.nome || "Conformidade") },
                { "id": "jogador_B", "label": "Corpo Funcional\n(Autores do Manifesto)", "group": "actor", "interest": temConflito ? -7 : 2, "title": "Objetivo: Manuten√ß√£o de benef√≠cios / Flexibilidade" },
                { "id": "estrat_DD", "label": "Cen√°rio DD:\nImposi√ß√£o x Resist√™ncia", "group": "strategy", "color": "#ef4444", "title": "Queda de moral, judicializa√ß√£o e perda de produtividade oculta." },
                { "id": "estrat_CC", "label": "Cen√°rio CC:\nAlinhamento T√°tico", "group": "strategy", "color": "#10b981", "title": "Gest√£o mant√©m regra, mas oferece contrapartida operacional." }
              ],
              "edges": [
                { "from": "jogador_A", "to": "decisao_oficial", "label": "Imp√µe", "arrows": "to" },
                { "from": "jogador_B", "to": "decisao_oficial", "label": "Sofre Impacto", "arrows": "to" },
                { "from": "estrat_DD", "to": "jogador_B", "label": "Risco Iminente", "arrows": "to", "dashes": true, "color": { "color": "#ef4444" } },
                { "from": "estrat_CC", "to": "jogador_B", "label": "Rota de Mitiga√ß√£o", "arrows": "to", "width": 2, "color": { "color": "#10b981" } }
              ],
              "gameMatrix": {
                "currentState": temConflito ? "DD" : "DC",
                "targetState": "CC",
                "payoffs": {
                  "CC": { "A": 6, "B": 5, "description": "Conformidade com manuten√ß√£o de engajamento." },
                  "CD": { "A": -2, "B": 6, "description": "Recuo institucional enfraquece a governan√ßa." },
                  "DC": { "A": 7, "B": -4, "description": "Conformidade for√ßada; risco de Turnover." },
                  "DD": { "A": -3, "B": -3, "description": "Conflito aberto, desgaste institucional." }
                }
              }
            };
            
            downloadJSON(playsData, 'Auditoria_Projecao_PLAYS.json');
            
            // Abre o PLAYS na mesma pasta do GitHub Pages
            setTimeout(() => {
                window.open('plays.html', '_blank');
            }, 1000);
        }
		// =====================================================================
        // MOTOR DE PROJE√á√ÉO (Teoria dos Jogos / PLAYS Embutido)
        // =====================================================================
        function renderizarProjecaoPlays() {
            const container = document.getElementById('matriz-plays-container');
            
            // Verifica se h√° conflito (manifesto/oposi√ß√£o)
            const temConflito = dadosAuditoria.alertas.some(a => a.includes("Disputa") || a.includes("Vi√©s"));
            
            // Defini√ß√£o dos Atores
            const decisor = "A: Gest√£o";
            const impactado = "B: Equipes";
            
            // Estado de Nash (Se h√° conflito, tende a DD. Se n√£o, tende a DC)
            const nashState = temConflito ? "DD (Conflito/Travamento)" : "DC (Conformidade Passiva)";
            const bgColorNash = temConflito ? "bg-red-100 border-red-300" : "bg-blue-100 border-blue-300";
            const txtColorNash = temConflito ? "text-red-700" : "text-blue-700";

            // Desenha a Matriz 2x2 Simplificada
            container.innerHTML = `
                <div class="mb-3">
                    <span class="text-[10px] font-bold text-slate-500 uppercase">Equil√≠brio de Nash Projetado:</span>
                    <div class="mt-1 font-bold text-sm ${txtColorNash} ${bgColorNash} border px-3 py-2 rounded">
                        ${nashState}
                    </div>
                </div>

                <div class="grid grid-cols-3 gap-1 text-center text-[10px]">
                    <div></div>
                    <div class="font-bold text-slate-600 bg-slate-200 py-1 rounded rounded-b-none">${impactado}<br>Aceita/Coopera</div>
                    <div class="font-bold text-slate-600 bg-slate-200 py-1 rounded rounded-b-none">${impactado}<br>Resiste/Rejeita</div>
                    
                    <div class="font-bold text-slate-600 bg-slate-200 py-2 flex items-center justify-center rounded rounded-r-none">${decisor}<br>Alinha/Mitiga</div>
                    <div class="border border-slate-300 bg-white p-2 flex flex-col justify-center">
                        <span class="font-bold text-emerald-600 text-xs">CC (Ganha-Ganha)</span>
                        <span class="text-[9px] text-slate-500 mt-1">Produtividade e Controle</span>
                    </div>
                    <div class="border border-slate-300 bg-white p-2 flex flex-col justify-center opacity-60">
                        <span class="font-bold text-slate-700 text-xs">CD</span>
                        <span class="text-[9px] text-slate-500 mt-1">Perda de Autoridade</span>
                    </div>
                    
                    <div class="font-bold text-slate-600 bg-slate-200 py-2 flex items-center justify-center rounded rounded-r-none">${decisor}<br>Imp√µe Rigor</div>
                    <div class="border border-slate-300 bg-white p-2 flex flex-col justify-center ${!temConflito ? 'ring-2 ring-blue-400 bg-blue-50' : 'opacity-60'}">
                        <span class="font-bold text-slate-700 text-xs">DC</span>
                        <span class="text-[9px] text-slate-500 mt-1">Risco de Turnover</span>
                    </div>
                    <div class="border border-slate-300 bg-white p-2 flex flex-col justify-center ${temConflito ? 'ring-2 ring-red-400 bg-red-50' : 'opacity-60'}">
                        <span class="font-bold ${temConflito ? 'text-red-600' : 'text-slate-700'} text-xs">DD (Perde-perde)</span>
                        <span class="text-[9px] text-slate-500 mt-1">Desgaste e Queda Oculta</span>
                    </div>
                </div>
                
                <p class="text-[10px] text-slate-500 mt-3 italic text-center">
                    ${temConflito 
                        ? "Aviso: A imposi√ß√£o r√≠gida frente a forte oposi√ß√£o documental trava a matriz no quadrante DD. Recomenda-se estrat√©gia de mitiga√ß√£o (CC)."
                        : "Cen√°rio de conformidade com submiss√£o (DC). Monitorar indicadores de reten√ß√£o de talentos no m√©dio prazo."}
                </p>
            `;
        }
    </script>
</body>

</html>























